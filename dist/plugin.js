!function(v,A){"object"==typeof exports&&"object"==typeof module?module.exports=A(require("ionic.angular"),require("ng.common"),require("ng.core"),require("ng.forms"),require("ngx-translate.core"),require("rxjs"),require("tslib"),require("wako-app.mobile-sdk")):"function"==typeof define&&define.amd?define(["ionic.angular","ng.common","ng.core","ng.forms","ngx-translate.core","rxjs","tslib","wako-app.mobile-sdk"],A):"object"==typeof exports?exports.plugin=A(require("ionic.angular"),require("ng.common"),require("ng.core"),require("ng.forms"),require("ngx-translate.core"),require("rxjs"),require("tslib"),require("wako-app.mobile-sdk")):v.plugin=A(v["ionic.angular"],v["ng.common"],v["ng.core"],v["ng.forms"],v["ngx-translate.core"],v.rxjs,v.tslib,v["wako-app.mobile-sdk"])}("undefined"!=typeof self?self:this,function(te,v,A,we,Pe,ke,Ee,xe){return function(){"use strict";var Ce={300:function(l){l.exports=te},575:function(l){l.exports=v},13:function(l){l.exports=A},498:function(l){l.exports=we},351:function(l){l.exports=Pe},435:function(l){l.exports=ke},780:function(l){l.exports=Ee},107:function(l){l.exports=xe}},ne={};function d(l){var g=ne[l];if(void 0!==g)return g.exports;var p=ne[l]={exports:{}};return Ce[l](p,p.exports,d),p.exports}d.d=function(l,g){for(var p in g)d.o(g,p)&&!d.o(l,p)&&Object.defineProperty(l,p,{enumerable:!0,get:g[p]})},d.o=function(l,g){return Object.prototype.hasOwnProperty.call(l,g)},d.r=function(l){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})};var $={};return function(){d.r($),d.d($,{PluginModule:function(){return Se},default:function(){return pt}});var l=d(780),g=d(575),p=d(300),f=d(107),T=d(351),w=d(435);function P(i){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(i)}function I(i,e,t){return(I="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(r,s,a){var u=function(i,e){for(;!Object.prototype.hasOwnProperty.call(i,e)&&null!==(i=P(i)););return i}(r,s);if(u){var c=Object.getOwnPropertyDescriptor(u,s);return c.get?c.get.call(a):c.value}})(i,e,t||i)}function G(i,e){return(G=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(i,e)}function k(i,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),e&&G(i,e)}function L(i){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(i)}function C(i){if(void 0===i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Ie(i,e){return!e||"object"!==L(e)&&"function"!=typeof e?C(i):e}function E(i){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(i){return!1}}();return function(){var r,n=P(i);if(e){var s=P(this).constructor;r=Reflect.construct(n,arguments,s)}else r=n.apply(this,arguments);return Ie(this,r)}}function m(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function re(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function b(i,e,t){return e&&re(i.prototype,e),t&&re(i,t),i}function H(i){return"function"==typeof i}var J=!1,y={Promise:void 0,set useDeprecatedSynchronousErrorHandling(i){if(i){var e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else J&&console.log("RxJS: Back to a better error behavior. Thank you. <3");J=i},get useDeprecatedSynchronousErrorHandling(){return J}};function U(i){setTimeout(function(){throw i},0)}var N={closed:!0,next:function(e){},error:function(e){if(y.useDeprecatedSynchronousErrorHandling)throw e;U(e)},complete:function(){}},je=function(){return Array.isArray||function(i){return i&&"number"==typeof i.length}}();function ie(i){return null!==i&&"object"==typeof i}var V=function(){function i(e){return Error.call(this),this.message=e?"".concat(e.length," errors occurred during unsubscription:\n").concat(e.map(function(t,n){return"".concat(n+1,") ").concat(t.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=e,this}return i.prototype=Object.create(Error.prototype),i}(),R=function(){var e,i=function(){function e(t){m(this,e),this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return b(e,[{key:"unsubscribe",value:function(){var n;if(!this.closed){var r=this._parentOrParents,s=this._unsubscribe,a=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var u=0;u<r.length;++u)r[u].remove(this);if(H(s))try{s.call(this)}catch(M){n=M instanceof V?oe(M.errors):[M]}if(je(a))for(var h=-1,D=a.length;++h<D;){var K=a[h];if(ie(K))try{K.unsubscribe()}catch(M){n=n||[],M instanceof V?n=n.concat(oe(M.errors)):n.push(M)}}if(n)throw new V(n)}}},{key:"add",value:function(n){var r=n;if(!n)return e.EMPTY;switch(typeof n){case"function":r=new e(n);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){var s=r;(r=new e)._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+n+" added to Subscription.")}var u=r._parentOrParents;if(null===u)r._parentOrParents=this;else if(u instanceof e){if(u===this)return r;r._parentOrParents=[u,this]}else{if(-1!==u.indexOf(this))return r;u.push(this)}var c=this._subscriptions;return null===c?this._subscriptions=[r]:c.push(r),r}},{key:"remove",value:function(n){var r=this._subscriptions;if(r){var s=r.indexOf(n);-1!==s&&r.splice(s,1)}}}]),e}();return i.EMPTY=((e=new i).closed=!0,e),i}();function oe(i){return i.reduce(function(e,t){return e.concat(t instanceof V?t.errors:t)},[])}var W=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),_=function(i){k(t,i);var e=E(t);function t(n,r,s){var a;switch(m(this,t),(a=e.call(this)).syncErrorValue=null,a.syncErrorThrown=!1,a.syncErrorThrowable=!1,a.isStopped=!1,arguments.length){case 0:a.destination=N;break;case 1:if(!n){a.destination=N;break}if("object"==typeof n){n instanceof t?(a.syncErrorThrowable=n.syncErrorThrowable,a.destination=n,n.add(C(a))):(a.syncErrorThrowable=!0,a.destination=new se(C(a),n));break}default:a.syncErrorThrowable=!0,a.destination=new se(C(a),n,r,s)}return a}return b(t,[{key:W,value:function(){return this}},{key:"next",value:function(r){this.isStopped||this._next(r)}},{key:"error",value:function(r){this.isStopped||(this.isStopped=!0,this._error(r))}},{key:"complete",value:function(){this.isStopped||(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,I(P(t.prototype),"unsubscribe",this).call(this))}},{key:"_next",value:function(r){this.destination.next(r)}},{key:"_error",value:function(r){this.destination.error(r),this.unsubscribe()}},{key:"_complete",value:function(){this.destination.complete(),this.unsubscribe()}},{key:"_unsubscribeAndRecycle",value:function(){var r=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=r,this}}],[{key:"create",value:function(r,s,a){var u=new t(r,s,a);return u.syncErrorThrowable=!1,u}}]),t}(R),se=function(i){k(t,i);var e=E(t);function t(n,r,s,a){var u;m(this,t),(u=e.call(this))._parentSubscriber=n;var c,h=C(u);return H(r)?c=r:r&&(c=r.next,s=r.error,a=r.complete,r!==N&&(H((h=Object.create(r)).unsubscribe)&&u.add(h.unsubscribe.bind(h)),h.unsubscribe=u.unsubscribe.bind(C(u)))),u._context=h,u._next=c,u._error=s,u._complete=a,u}return b(t,[{key:"next",value:function(r){if(!this.isStopped&&this._next){var s=this._parentSubscriber;y.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable?this.__tryOrSetError(s,this._next,r)&&this.unsubscribe():this.__tryOrUnsub(this._next,r)}}},{key:"error",value:function(r){if(!this.isStopped){var s=this._parentSubscriber,a=y.useDeprecatedSynchronousErrorHandling;if(this._error)a&&s.syncErrorThrowable?(this.__tryOrSetError(s,this._error,r),this.unsubscribe()):(this.__tryOrUnsub(this._error,r),this.unsubscribe());else if(s.syncErrorThrowable)a?(s.syncErrorValue=r,s.syncErrorThrown=!0):U(r),this.unsubscribe();else{if(this.unsubscribe(),a)throw r;U(r)}}}},{key:"complete",value:function(){var r=this;if(!this.isStopped){var s=this._parentSubscriber;if(this._complete){var a=function(){return r._complete.call(r._context)};y.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable?(this.__tryOrSetError(s,a),this.unsubscribe()):(this.__tryOrUnsub(a),this.unsubscribe())}else this.unsubscribe()}}},{key:"__tryOrUnsub",value:function(r,s){try{r.call(this._context,s)}catch(a){if(this.unsubscribe(),y.useDeprecatedSynchronousErrorHandling)throw a;U(a)}}},{key:"__tryOrSetError",value:function(r,s,a){if(!y.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{s.call(this._context,a)}catch(u){return y.useDeprecatedSynchronousErrorHandling?(r.syncErrorValue=u,r.syncErrorThrown=!0,!0):(U(u),!0)}return!1}},{key:"_unsubscribe",value:function(){var r=this._parentSubscriber;this._context=null,this._parentSubscriber=null,r.unsubscribe()}}]),t}(_),ae=function(i){k(t,i);var e=E(t);function t(){return m(this,t),e.apply(this,arguments)}return b(t,[{key:"notifyNext",value:function(r,s,a,u,c){this.destination.next(s)}},{key:"notifyError",value:function(r,s){this.destination.error(r)}},{key:"notifyComplete",value:function(r){this.destination.complete()}}]),t}(_),Q=function(i){k(t,i);var e=E(t);function t(n,r,s){var a;return m(this,t),(a=e.call(this)).parent=n,a.outerValue=r,a.outerIndex=s,a.index=0,a}return b(t,[{key:"_next",value:function(r){this.parent.notifyNext(this.outerValue,r,this.outerIndex,this.index++,this)}},{key:"_error",value:function(r){this.parent.notifyError(r,this),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(this),this.unsubscribe()}}]),t}(_);function Re(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var q=Re(),F=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}(),ue=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function ce(i){return!!i&&"function"!=typeof i.subscribe&&"function"==typeof i.then}var le=function(e){if(e&&"function"==typeof e[F])return function(e){return function(t){var n=e[F]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(t)}}(e);if(ue(e))return function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}}(e);if(ce(e))return function(e){return function(t){return e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,U),t}}(e);if(e&&"function"==typeof e[q])return function(e){return function(t){for(var n=e[q]();;){var r=n.next();if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof n.return&&t.add(function(){n.return&&n.return()}),t}}(e);var t=ie(e)?"an invalid object":"'".concat(e,"'"),n="You provided ".concat(t," where a stream was expected.")+" You can provide an Observable, Promise, Array, or Iterable.";throw new TypeError(n)};function Le(i){return i}function fe(i){return 0===i.length?Le:1===i.length?i[0]:function(t){return i.reduce(function(n,r){return r(n)},t)}}var j=function(){var i=function(){function e(t){m(this,e),this._isScalar=!1,t&&(this._subscribe=t)}return b(e,[{key:"lift",value:function(n){var r=new e;return r.source=this,r.operator=n,r}},{key:"subscribe",value:function(n,r,s){var a=this.operator,u=function(i,e,t){if(i){if(i instanceof _)return i;if(i[W])return i[W]()}return i||e||t?new _(i,e,t):new _(N)}(n,r,s);if(u.add(a?a.call(u,this.source):this.source||y.useDeprecatedSynchronousErrorHandling&&!u.syncErrorThrowable?this._subscribe(u):this._trySubscribe(u)),y.useDeprecatedSynchronousErrorHandling&&u.syncErrorThrowable&&(u.syncErrorThrowable=!1,u.syncErrorThrown))throw u.syncErrorValue;return u}},{key:"_trySubscribe",value:function(n){try{return this._subscribe(n)}catch(r){y.useDeprecatedSynchronousErrorHandling&&(n.syncErrorThrown=!0,n.syncErrorValue=r),function(i){for(;i;){var n=i.destination;if(i.closed||i.isStopped)return!1;i=n&&n instanceof _?n:null}return!0}(n)?n.error(r):console.warn(r)}}},{key:"forEach",value:function(n,r){var s=this;return new(r=pe(r))(function(a,u){var c;c=s.subscribe(function(h){try{n(h)}catch(D){u(D),c&&c.unsubscribe()}},u,a)})}},{key:"_subscribe",value:function(n){var r=this.source;return r&&r.subscribe(n)}},{key:F,value:function(){return this}},{key:"pipe",value:function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return 0===r.length?this:fe(r)(this)}},{key:"toPromise",value:function(n){var r=this;return new(n=pe(n))(function(s,a){var u;r.subscribe(function(c){return u=c},function(c){return a(c)},function(){return s(u)})})}}]),e}();return i.create=function(e){return new i(e)},i}();function pe(i){if(i||(i=y.Promise||Promise),!i)throw new Error("no Promise impl found");return i}function he(i,e,t,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Q(i,t,n);if(!r.closed)return e instanceof j?e.subscribe(r):le(e)(r)}function B(i,e){return function(n){if("function"!=typeof i)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new He(i,e))}}var He=function(){function i(e,t){m(this,i),this.project=e,this.thisArg=t}return b(i,[{key:"call",value:function(t,n){return n.subscribe(new Ne(t,this.project,this.thisArg))}}]),i}(),Ne=function(i){k(t,i);var e=E(t);function t(n,r,s){var a;return m(this,t),(a=e.call(this,n)).project=r,a.count=0,a.thisArg=s||C(a),a}return b(t,[{key:"_next",value:function(r){var s;try{s=this.project.call(this.thisArg,r,this.count++)}catch(a){return void this.destination.error(a)}this.destination.next(s)}}]),t}(_);function S(i,e){return"function"==typeof e?function(t){return t.pipe(S(function(n,r){return function(i,e){return i instanceof j?i:new j(le(i))}(i(n,r)).pipe(B(function(s,a){return e(n,s,r,a)}))}))}:function(t){return t.lift(new Qe(i))}}var Qe=function(){function i(e){m(this,i),this.project=e}return b(i,[{key:"call",value:function(t,n){return n.subscribe(new Xe(t,this.project))}}]),i}(),Xe=function(i){k(t,i);var e=E(t);function t(n,r){var s;return m(this,t),(s=e.call(this,n)).project=r,s.index=0,s}return b(t,[{key:"_next",value:function(r){var s,a=this.index++;try{s=this.project(r,a)}catch(u){return void this.destination.error(u)}this._innerSub(s,r,a)}},{key:"_innerSub",value:function(r,s,a){var u=this.innerSubscription;u&&u.unsubscribe();var c=new Q(this,s,a),h=this.destination;h.add(c),this.innerSubscription=he(this,r,void 0,void 0,c),this.innerSubscription!==c&&h.add(this.innerSubscription)}},{key:"_complete",value:function(){var r=this.innerSubscription;(!r||r.closed)&&I(P(t.prototype),"_complete",this).call(this),this.unsubscribe()}},{key:"_unsubscribe",value:function(){this.innerSubscription=null}},{key:"notifyComplete",value:function(r){this.destination.remove(r),this.innerSubscription=null,this.isStopped&&I(P(t.prototype),"_complete",this).call(this)}},{key:"notifyNext",value:function(r,s,a,u,c){this.destination.next(s)}}]),t}(ae);function X(i){return function(t){var n=new Ze(i),r=t.lift(n);return n.caught=r}}var Ze=function(){function i(e){m(this,i),this.selector=e}return b(i,[{key:"call",value:function(t,n){return n.subscribe(new et(t,this.selector,this.caught))}}]),i}(),et=function(i){k(t,i);var e=E(t);function t(n,r,s){var a;return m(this,t),(a=e.call(this,n)).selector=r,a.caught=s,a}return b(t,[{key:"error",value:function(r){if(!this.isStopped){var s;try{s=this.selector(r,this.caught)}catch(c){return void I(P(t.prototype),"error",this).call(this,c)}this._unsubscribeAndRecycle();var a=new Q(this,void 0,void 0);this.add(a);var u=he(this,s,void 0,void 0,a);u!==a&&this.add(u)}}}]),t}(ae);function O(){}function de(i,e,t){return function(r){return r.lift(new tt(i,e,t))}}var tt=function(){function i(e,t,n){m(this,i),this.nextOrObserver=e,this.error=t,this.complete=n}return b(i,[{key:"call",value:function(t,n){return n.subscribe(new nt(t,this.nextOrObserver,this.error,this.complete))}}]),i}(),nt=function(i){k(t,i);var e=E(t);function t(n,r,s,a){var u;return m(this,t),(u=e.call(this,n))._tapNext=O,u._tapError=O,u._tapComplete=O,u._tapError=s||O,u._tapComplete=a||O,H(r)?(u._context=C(u),u._tapNext=r):r&&(u._context=r,u._tapNext=r.next||O,u._tapError=r.error||O,u._tapComplete=r.complete||O),u}return b(t,[{key:"_next",value:function(r){try{this._tapNext.call(this._context,r)}catch(s){return void this.destination.error(s)}this.destination.next(r)}},{key:"_error",value:function(r){try{this._tapError.call(this._context,r)}catch(s){return void this.destination.error(s)}this.destination.error(r)}},{key:"_complete",value:function(){try{this._tapComplete.call(this._context)}catch(r){return void this.destination.error(r)}return this.destination.complete()}}]),t}(_),o=d(13),Z=function(){function i(e,t){this.toastCtrl=e,this.translateService=t}return i.prototype.simpleMessage=function(e,t,n,r){var s=this;void 0===n&&(n=2e3),void 0===r&&(r="top"),this.translateService.get(e,t).subscribe(function(a){s.toastCtrl.create({message:a,mode:"ios",position:r,duration:n}).then(function(u){u.present()})})},i.\u0275fac=function(t){return new(t||i)(o.\u0275\u0275inject(p.ToastController),o.\u0275\u0275inject(T.TranslateService))},i.\u0275prov=o.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}();function x(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];(0,f.wakoLog)("plugin.nomos",i)}var me="CACHE_KEY_PLUGINS",z=function(){function i(e,t,n,r){this.toastService=e,this.storage=t,this.actionSheetController=n,this.translateService=r}return i.prototype.patchStorageKey=function(){return(0,l.__awaiter)(this,void 0,void 0,function(){var e,t,n;return(0,l.__generator)(this,function(r){switch(r.label){case 0:return[4,this.storage.get("kodi-plugins-url")];case 1:return(e=r.sent())?[4,this.storage.set(this.getStorageKeyPrefixed("kodi-plugins-url"),e)]:[3,4];case 2:return r.sent(),[4,this.storage.remove("kodi-plugins-url")];case 3:r.sent(),r.label=4;case 4:return[4,this.storage.get("kodi-plugins-list")];case 5:return(t=r.sent())?[4,this.storage.set(this.getStorageKeyPrefixed("kodi-plugins-list"),t)]:[3,8];case 6:return r.sent(),[4,this.storage.remove("kodi-plugins-list")];case 7:r.sent(),r.label=8;case 8:return[4,this.storage.get("openRemoteAfterClickOnPlay")];case 9:return(n=r.sent())?[4,this.storage.set(this.getStorageKeyPrefixed("openRemoteAfterClickOnPlay"),n)]:[3,12];case 10:return r.sent(),[4,this.storage.remove("openRemoteAfterClickOnPlay")];case 11:r.sent(),r.label=12;case 12:return[2]}})})},i.prototype.getStorageKeyPrefixed=function(e){return"nomos_"+e},i.prototype.getPluginUrl=function(){return this.storage.get(this.getStorageKeyPrefixed("kodi-plugins-url"))},i.prototype.setPluginUrl=function(e){return this.storage.set(this.getStorageKeyPrefixed("kodi-plugins-url"),e)},i.prototype.getPlugins=function(){return this.storage.get(this.getStorageKeyPrefixed("kodi-plugins-list"))},i.prototype.setPlugins=function(e,t){var n=this;return void 0===t&&(t=!1),this.getPlugins().then(function(r){if(r&&t){var s=Object.keys(r).length===Object.keys(e).length;s&&Object.keys(r).forEach(function(a){var u=Object.assign({},r[a]),c=Object.assign({},e[a]);u.enabled=!0,c.enabled=!0,JSON.stringify(u)!==JSON.stringify(c)&&(s=!1)}),s?x("no changes in plugins"):n.toastService.simpleMessage("toasts.pluginsUpdated"),Object.keys(r).forEach(function(a){e.hasOwnProperty(a)&&(e[a].enabled=r[a].enabled)})}return n.storage.set(n.getStorageKeyPrefixed("kodi-plugins-list"),e)})},i.prototype.setPluginsFromUrl=function(e,t){var n=this;return void 0===t&&(t=!1),e=e.trim(),f.WakoHttpRequestService.request({url:e,method:"GET"},null,1e4,!0).pipe(S(function(r){return"string"==typeof r||0===Object.keys(r).length?(0,w.of)(!1):(t||Object.keys(r).forEach(function(s){r[s].enabled=!0}),(0,w.from)(n.setPlugins(r,t)).pipe(S(function(){return(0,w.from)(n.setPluginUrl(e))}),B(function(){return!0})))}),X(function(){return(0,w.of)(!1)}))},i.prototype.refreshPlugins=function(){var e=this;f.WakoCacheService.get(me).subscribe(function(t){t?x("check plugins later"):(e.getPluginUrl().then(function(n){n&&e.setPluginsFromUrl(n,!0).subscribe()}),f.WakoCacheService.set(me,!0,"1d"))})},i.prototype.getOpenRemoteAfterClickOnPlaySetting=function(){return this.storage.get(this.getStorageKeyPrefixed("openRemoteAfterClickOnPlay")).then(function(e){return!!e})},i.prototype.setOpenRemoteAfterClickOnPlaySetting=function(e){return this.storage.set(this.getStorageKeyPrefixed("openRemoteAfterClickOnPlay"),e)},i.prototype.getPluginsByCategory=function(e){return(0,w.from)(this.getPlugins()).pipe(B(function(t){if(!t)return null;var n={};return Object.keys(t).forEach(function(r){var s=t[r];!s.enabled||("movie"===e&&s.movieUrl||"episode"===e&&s.tvUrl)&&(n[r]=s)}),n}))},i.prototype.getInstalledPlugins=function(){return f.KodiGetAddonsForm.submit().pipe(X(function(){return(0,w.of)({addons:[]})}),B(function(e){var t=[];return e.addons.forEach(function(n){t.push(n.addonid)}),t}))},i.prototype.open=function(e){var t=this,n={};f.KodiAppService.checkAndConnectToCurrentHost().pipe(X(function(r){return"hostUnreachable"===r?t.toastService.simpleMessage("toasts.kodi.hostUnreachable",{hostName:f.KodiAppService.currentHost.name},2e3):t.toastService.simpleMessage("toasts.kodi.noHost"),w.NEVER}),S(function(){return x("CONNECTED"),t.getPluginsByCategory(e.category).pipe(de(function(r){n=r||{}}))}),S(function(){return t.getInstalledPlugins()}),B(function(r){x("_installedPlugins",r);var s=[];return Object.keys(n).forEach(function(a){r.includes(n[a].plugin)&&s.push(a)}),s})).subscribe(function(r){if(x("supportedAndInstalledPlugins",r),0!==r.length)if(1!==r.length){var s=[];Object.keys(n).forEach(function(a){var u=n[a];r.includes(a)&&s.push({text:u.name,handler:function(){t.openOnPlugin(a,e)}})}),x("buttons",s),1!==s.length?t.actionSheetController.create({header:t.translateService.instant("actionSheets.kodi.openTitle"),buttons:s}).then(function(a){a.present()}):s[0].handler()}else t.openOnPlugin(r[0],e);else t.toastService.simpleMessage("toasts.kodi.noSupportedPluginsInstalled")})},i.prototype.openViaPlaylist=function(e,t,n){return(0,w.of)(!0).pipe(S(function(){return f.KodiApiService.doHttpAction("Playlist.Clear",{playlistid:0})}),S(function(){return f.KodiApiService.doHttpAction("Playlist.Insert",{playlistid:0,item:{file:e},position:0})}),S(function(){return f.KodiAppService.stopPlayingIfAny()}),S(function(){return f.KodiApiService.doHttpAction("Player.open",{item:{playlistid:0}})}),B(function(){return n&&f.EventService.emit(f.EventCategory.kodiRemote,f.EventName.open),t&&f.KodiAppService.openMedia$.next(t),f.EventService.emit(f.EventCategory.kodi,f.EventName.open),!0}))},i.prototype.openOnPlugin=function(e,t){var n=this;this.getPlugins().then(function(r){var s=r[e],u={hostName:f.KodiApiService.host.name,pluginName:s.name},c=n.getKodiPluginParams(s,t);return(0,w.from)(n.getOpenRemoteAfterClickOnPlaySetting()).pipe(S(function(h){var D={movieIds:t.movie?t.movie.ids:null,showIds:t.show?t.show.ids:null,seasonNumber:t.episode?t.episode.seasonNumber:null,episodeNumber:t.episode?t.episode.number:null},K="plugin://"+s.plugin+c;return x("Opening: "+K),n.openViaPlaylist(K,D,h)}),de(function(h){h?n.toastService.simpleMessage("toasts.kodi.open",u):n.toastService.simpleMessage("toasts.kodi.failedToOpen")})).subscribe()})},i.prototype.replacePlus=function(e){return e?e.replace(/\s/g,"+"):""},i.prototype.getKodiPluginParams=function(e,t){if(t.movie){var n=t.movie,r={tmdbId:n.ids.tmdb,rating:n.rating,date:n.released,title:n.title,tagline:n.tagline,plot:n.overview,original_title:n.originalTitle,imdb:n.ids.imdb,year:n.year,duration:60*n.runtime,mpaa:n.certification,genres:n.genres.join(" / "),fanart:n.imagesUrl.backdropOriginal,poster:n.imagesUrl.posterOriginal,id:n.ids.tmdb,slug:"",trakt:n.ids.trakt,showTmdbId:null,seasonNumber:null,episodeNumber:null,"title_+":this.replacePlus(n.title),tvdb:null,season:null,episode:null,"clearname_+":this.replacePlus(n.title),firstaired:n.released,"plot_+":this.replacePlus(n.overview),thumbnail:n.imagesUrl.backdropOriginal,now:Date.now().toString(),banner:n.imagesUrl.backdropOriginal,epimdb:null,eptmdb:null,eptrakt:null,epid:null,network_clean:"",clearname:n.title,epyear:null,tmdb:n.ids.tmdb,episodes:null,seasons:null,series_firstaired:null,seasons_no_specials:null,status:null,premiered:n.released};return this.getPluginParams(e.movieUrl,r)}var s=t.show,a=t.episode,u="2019-01-01";s.firstAired&&(u=s.firstAired);var c=new Date;return"string"==typeof a.firstAired&&(c=new Date(a.firstAired)),r={showTmdbId:s.ids.tmdb,seasonNumber:a.seasonNumber,episodeNumber:a.number,"title_+":this.replacePlus(a.title),year:s.year,imdb:s.ids.imdb,tvdb:+s.ids.tvdb,season:a.seasonNumber,episode:a.number,"clearname_+":this.replacePlus(s.title),firstaired:u,duration:60*a.runtime,"plot_+":this.replacePlus(a.overview),thumbnail:s.imagesUrl.backdropOriginal,id:+s.ids.tvdb,poster:s.imagesUrl.posterOriginal,fanart:s.imagesUrl.backdropOriginal,now:Date.now().toString(),banner:s.imagesUrl.backdropOriginal,epimdb:a.ids.imdb,eptmdb:0,eptrakt:0,epid:+a.ids.tvdb,genres:"",mpaa:s.certification,title:a.title,plot:a.overview,rating:a.rating,network_clean:"",clearname:s.title,epyear:c?c.getFullYear():null,slug:"",tmdb:s.ids.tmdb,trakt:s.ids.trakt,episodes:1,seasons:1,series_firstaired:u,seasons_no_specials:1,status:"Continuing",tmdbId:s.ids.tmdb,date:u,tagline:"",original_title:a.title,premiered:u},this.getPluginParams(e.tvUrl,r)},i.prototype.getPluginParams=function(e,t){return Object.keys(t).forEach(function(n){var r=(0,f.escapeText)(t[n]);n.match(/\+/g)||(t[n]=encodeURIComponent(r))}),(0,f.replacer)(e,t)},i.\u0275fac=function(t){return new(t||i)(o.\u0275\u0275inject(Z),o.\u0275\u0275inject(f.WakoStorage),o.\u0275\u0275inject(p.ActionSheetController),o.\u0275\u0275inject(T.TranslateService))},i.\u0275prov=o.\u0275\u0275defineInjectable({token:i,factory:i.\u0275fac}),i}(),be=function(i){function e(t,n){var r=i.call(this)||this;return r.translate=t,r.kodiPluginService=n,r}return(0,l.__extends)(e,i),e.prototype.initialize=function(){var t=this;x("plugin initialized"),setTimeout(function(){t.kodiPluginService.refreshPlugins()},1e4),this.kodiPluginService.patchStorageKey()},e.prototype.afterInstall=function(){x("plugin installed")},e.prototype.setTranslation=function(t,n){this.translate.setDefaultLang(t),this.translate.use(t),this.translate.setTranslation(t,n)},e.prototype.customAction=function(t,n){},e.prototype.afterEpisodeMiddleware=function(t,n){return Promise.resolve(void 0)},e.prototype.afterMovieMiddleware=function(t){return Promise.resolve(void 0)},e.prototype.afterShowMiddleware=function(t){return Promise.resolve(void 0)},e.prototype.beforeEpisodeMiddleware=function(t,n){return Promise.resolve(void 0)},e.prototype.beforeMovieMiddleware=function(t){return Promise.resolve(void 0)},e.prototype.beforeShowMiddleware=function(t){return Promise.resolve(void 0)},e.prototype.fetchExplorerFolderItem=function(){throw new Error("Method not implemented.")},e.prototype.getFileActionButtons=function(t,n,r,s,a,u){throw new Error("Method not implemented.")},e.\u0275fac=function(n){return new(n||e)(o.\u0275\u0275inject(T.TranslateService),o.\u0275\u0275inject(z))},e.\u0275prov=o.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e}(f.PluginBaseService);function it(i,e){if(1&i){var t=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementContainerStart(0),o.\u0275\u0275elementStart(1,"ion-button",1),o.\u0275\u0275listener("click",function(){return o.\u0275\u0275restoreView(t),o.\u0275\u0275nextContext().open()}),o.\u0275\u0275element(2,"ion-icon",2),o.\u0275\u0275elementStart(3,"ion-text",3),o.\u0275\u0275text(4),o.\u0275\u0275pipe(5,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementContainerEnd()}2&i&&(o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(5,1,"shared.buttonOpenKodi")))}function ot(i,e){if(1&i){var t=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementContainerStart(0),o.\u0275\u0275elementStart(1,"div",4),o.\u0275\u0275elementStart(2,"ion-item-option",5),o.\u0275\u0275listener("click",function(){return o.\u0275\u0275restoreView(t),o.\u0275\u0275nextContext().open()}),o.\u0275\u0275elementStart(3,"div",6),o.\u0275\u0275element(4,"ion-icon",7),o.\u0275\u0275elementStart(5,"ion-text"),o.\u0275\u0275text(6," Nomos "),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementContainerEnd()}}var Y=function(){function i(e){this.kodiPluginService=e,this.type="button"}return i.prototype.open=function(){return(0,l.__awaiter)(this,void 0,void 0,function(){return(0,l.__generator)(this,function(e){return this.kodiPluginService.open({category:this.movie?"movie":"episode",movie:this.movie,show:this.show,episode:this.episode}),[2]})})},i.\u0275fac=function(t){return new(t||i)(o.\u0275\u0275directiveInject(z))},i.\u0275cmp=o.\u0275\u0275defineComponent({type:i,selectors:[["wk-open-button"]],inputs:{movie:"movie",show:"show",episode:"episode",type:"type"},decls:2,vars:2,consts:[[4,"ngIf"],["color","nomos","expand","block",1,"open-on-kodi",3,"click"],["name","play","color","light","slot","start"],["color","light"],[1,"ion-item-options"],["color","nomos",3,"click"],[1,"ion-item-detail"],["name","play"]],template:function(t,n){1&t&&(o.\u0275\u0275template(0,it,6,3,"ng-container",0),o.\u0275\u0275template(1,ot,7,0,"ng-container",0)),2&t&&(o.\u0275\u0275property("ngIf","button"===n.type),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf","item-option"===n.type))},directives:[g.NgIf,p.IonButton,p.IonIcon,p.IonText,p.IonItemOption],pipes:[T.TranslatePipe],styles:[".ion-color-nomos[_ngcontent-%COMP%]{--ion-color-base: #4b1d52;--ion-color-base-rgb: 53, 66, 82;--ion-color-contrast: #ffffff;--ion-color-contrast-rgb: 255, 255, 255;--ion-color-shade: #483247;--ion-color-tint: #635260}ion-button[_ngcontent-%COMP%]{--ripple-color: var(--ion-color-nomos);--background-activated: var(--ion-color-nomos);--background-focused: var(--ion-color-nomos)}.ion-item-options[_ngcontent-%COMP%]{display:flex;height:100%}.ion-item-options[_ngcontent-%COMP%]   .ion-item-detail[_ngcontent-%COMP%]{width:60px;display:grid;text-align:center}.ion-item-options[_ngcontent-%COMP%]   .ion-item-detail[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:2em;width:100%}.ion-item-options[_ngcontent-%COMP%]   .ion-item-detail[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{margin-top:3px;font-size:8px;text-transform:none}"]}),i}(),ge=function(i){function e(){return null!==i&&i.apply(this,arguments)||this}return(0,l.__extends)(e,i),e.prototype.setMovie=function(t){this.movie=t},e.\u0275fac=function(){var t;return function(r){return(t||(t=o.\u0275\u0275getInheritedFactory(e)))(r||e)}}(),e.\u0275cmp=o.\u0275\u0275defineComponent({type:e,selectors:[["app-movie-button"]],features:[o.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[[3,"movie"]],template:function(n,r){1&n&&o.\u0275\u0275element(0,"wk-open-button",0),2&n&&o.\u0275\u0275property("movie",r.movie)},directives:[Y],styles:[""]}),e}(f.MovieDetailBaseComponent),at=function(){function i(e){m(this,i),this.callback=e}return b(i,[{key:"call",value:function(t,n){return n.subscribe(new ut(t,this.callback))}}]),i}(),ut=function(i){k(t,i);var e=E(t);function t(n,r){var s;return m(this,t),(s=e.call(this,n)).add(new R(r)),s}return t}(_),ee=d(498);function ct(i,e){1&i&&o.\u0275\u0275element(0,"ion-spinner")}function lt(i,e){if(1&i){var t=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"ion-item"),o.\u0275\u0275elementStart(1,"ion-label"),o.\u0275\u0275text(2),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(3,"ion-toggle",4),o.\u0275\u0275listener("ionChange",function(s){var u=o.\u0275\u0275restoreView(t).$implicit;return o.\u0275\u0275nextContext(2).toggleProvider(u.key,s.detail.checked)}),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()}if(2&i){var n=e.$implicit;o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate1("",n.name," "),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngModel",n.enabled)}}function ft(i,e){if(1&i&&(o.\u0275\u0275elementStart(0,"ion-list",0),o.\u0275\u0275elementStart(1,"ion-list-header"),o.\u0275\u0275elementStart(2,"ion-label"),o.\u0275\u0275element(3,"ion-icon",6),o.\u0275\u0275text(4),o.\u0275\u0275pipe(5,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275template(6,lt,4,2,"ion-item",7),o.\u0275\u0275elementEnd()),2&i){var t=o.\u0275\u0275nextContext();o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(5,2,"pages.kodi-open-button.pluginList.header")," "),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngForOf",t.pluginArray)}}var ve=function(){function i(e,t,n,r){this.kodiPluginService=e,this.alertController=t,this.translateService=n,this.toastService=r,this.pluginArray=[],this.pluginsUrl=null,this.pluginsList=null,this.isLoading=!1}return i.prototype.ngOnInit=function(){var e=this;this.refresh(),this.kodiPluginService.getOpenRemoteAfterClickOnPlaySetting().then(function(t){e.openRemoteAfterClickOnPlay=t})},i.prototype.refresh=function(){var e=this;this.kodiPluginService.getPluginUrl().then(function(t){e.pluginsUrl=t}),this.kodiPluginService.getPlugins().then(function(t){e.pluginsList=t,e.pluginArray=[],t&&Object.keys(t).forEach(function(n){var r=t[n];e.pluginArray.push({key:n,enabled:r.enabled,name:r.name})})})},i.prototype.setUrl=function(){var e=this;this.alertController.create({header:"URL",inputs:[{name:"url",type:"url",placeholder:"URL",value:this.pluginsUrl?this.pluginsUrl:""}],buttons:[{text:this.translateService.instant("alerts.cancelButton"),role:"cancel",cssClass:"secondary"},{text:"Ok",handler:function(t){e.isLoading=!0,e.kodiPluginService.setPluginsFromUrl(t.url).pipe(function(i){return function(e){return e.lift(new at(i))}}(function(){return e.isLoading=!1})).subscribe(function(n){n?(e.toastService.simpleMessage("toasts.kodi-open-button.plugingUrlAdded"),e.refresh()):e.toastService.simpleMessage("toasts.kodi-open-button.plugingUrlFailedToAdd")})}}]}).then(function(t){t.present()})},i.prototype.toggleProvider=function(e,t){this.pluginsList[e].enabled=t,this.kodiPluginService.setPlugins(this.pluginsList)},i.prototype.openRemoteAfterClickOnPlayChange=function(e){this.openRemoteAfterClickOnPlay=e,this.kodiPluginService.setOpenRemoteAfterClickOnPlaySetting(this.openRemoteAfterClickOnPlay)},i.\u0275fac=function(t){return new(t||i)(o.\u0275\u0275directiveInject(z),o.\u0275\u0275directiveInject(p.AlertController),o.\u0275\u0275directiveInject(T.TranslateService),o.\u0275\u0275directiveInject(Z))},i.\u0275cmp=o.\u0275\u0275defineComponent({type:i,selectors:[["ng-component"]],decls:22,vars:18,consts:[["lines","full"],["name","cog","slot","start"],[4,"ngIf"],["button","",3,"click"],[3,"ngModel","ionChange"],["lines","full",4,"ngIf"],["name","list","slot","start"],[4,"ngFor","ngForOf"]],template:function(t,n){1&t&&(o.\u0275\u0275elementStart(0,"ion-list",0),o.\u0275\u0275elementStart(1,"ion-list-header"),o.\u0275\u0275elementStart(2,"ion-label"),o.\u0275\u0275element(3,"ion-icon",1),o.\u0275\u0275text(4),o.\u0275\u0275pipe(5,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275template(6,ct,1,0,"ion-spinner",2),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(7,"ion-item",3),o.\u0275\u0275listener("click",function(){return n.setUrl()}),o.\u0275\u0275text(8),o.\u0275\u0275pipe(9,"translate"),o.\u0275\u0275pipe(10,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(11,"ion-list",0),o.\u0275\u0275elementStart(12,"ion-list-header"),o.\u0275\u0275elementStart(13,"ion-label"),o.\u0275\u0275text(14),o.\u0275\u0275pipe(15,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(16,"ion-item"),o.\u0275\u0275elementStart(17,"ion-label"),o.\u0275\u0275text(18),o.\u0275\u0275pipe(19,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(20,"ion-toggle",4),o.\u0275\u0275listener("ionChange",function(s){return n.openRemoteAfterClickOnPlayChange(s.detail.checked)}),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275template(21,ft,7,4,"ion-list",5)),2&t&&(o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(5,8,"pages.kodi-open-button.list.header")," "),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",n.isLoading),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate2(" ",o.\u0275\u0275pipeBind1(9,10,"pages.kodi-open-button.list.pluginsUrl")," ",n.pluginsUrl?n.pluginsUrl:o.\u0275\u0275pipeBind1(10,12,"pages.kodi-open-button.list.noUrl")," "),o.\u0275\u0275advance(6),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(15,14,"pages.kodi-open-button.openRemoteList.header")," "),o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(19,16,"pages.kodi-open-button.openRemoteList.item"),""),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngModel",n.openRemoteAfterClickOnPlay),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",n.pluginsList))},directives:[p.IonList,p.IonListHeader,p.IonLabel,p.IonIcon,g.NgIf,p.IonItem,p.IonToggle,p.BooleanValueAccessor,ee.NgControlStatus,ee.NgModel,p.IonSpinner,g.NgForOf],pipes:[T.TranslatePipe],styles:[""]}),i}(),ye=function(i){function e(){return null!==i&&i.apply(this,arguments)||this}return(0,l.__extends)(e,i),e.prototype.setShowEpisode=function(t,n){this.show=t,this.episode=n},e.\u0275fac=function(){var t;return function(r){return(t||(t=o.\u0275\u0275getInheritedFactory(e)))(r||e)}}(),e.\u0275cmp=o.\u0275\u0275defineComponent({type:e,selectors:[["ng-component"]],features:[o.\u0275\u0275InheritDefinitionFeature],decls:1,vars:2,consts:[[3,"show","episode"]],template:function(n,r){1&n&&o.\u0275\u0275element(0,"wk-open-button",0),2&n&&o.\u0275\u0275property("show",r.show)("episode",r.episode)},directives:[Y],styles:[""]}),e}(f.EpisodeDetailBaseComponent),_e=function(i){function e(){return null!==i&&i.apply(this,arguments)||this}return(0,l.__extends)(e,i),e.prototype.setShowEpisode=function(t,n){this.show=t,this.episode=n},e.\u0275fac=function(){var t;return function(r){return(t||(t=o.\u0275\u0275getInheritedFactory(e)))(r||e)}}(),e.\u0275cmp=o.\u0275\u0275defineComponent({type:e,selectors:[["ng-component"]],features:[o.\u0275\u0275InheritDefinitionFeature],decls:1,vars:2,consts:[["type","item-option",3,"show","episode"]],template:function(n,r){1&n&&o.\u0275\u0275element(0,"wk-open-button",0),2&n&&o.\u0275\u0275property("show",r.show)("episode",r.episode)},directives:[Y],styles:[""]}),e}(f.EpisodeDetailBaseComponent),Se=function(i){function e(){return null!==i&&i.apply(this,arguments)||this}return(0,l.__extends)(e,i),e.pluginService=be,e.settingsComponent=ve,e.movieComponent=ge,e.episodeComponent=ye,e.episodeItemOptionComponent=_e,e.\u0275fac=function(){var t;return function(r){return(t||(t=o.\u0275\u0275getInheritedFactory(e)))(r||e)}}(),e.\u0275mod=o.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=o.\u0275\u0275defineInjector({providers:[be,z,Z],imports:[[g.CommonModule,ee.FormsModule,p.IonicModule.forRoot(),T.TranslateModule.forRoot()]]}),e}(f.PluginBaseModule),pt=Se}(),$}()});